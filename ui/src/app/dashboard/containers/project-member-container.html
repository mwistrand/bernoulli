<div class="members-container">
  <div class="members-header">
    <button
      class="back-button"
      (click)="goBack()"
      [attr.aria-label]="'projects.backToProject' | translate"
    >
      <lucide-icon
        [attr.aria-hidden]="true"
        [img]="ArrowLeftIcon"
        size="20"
        class="icon"
      ></lucide-icon>
      {{ 'projects.backToProject' | translate }}
    </button>

    @if (project()) {
      <div class="project-info">
        <h1>{{ project().name }} - {{ 'projects.membersPageTitle' | translate }}</h1>
      </div>
    }
  </div>

  <div class="members-content">
    @if (canManageMembers()) {
      <div class="actions-bar">
        <button class="button-primary" (click)="onAddMember()">
          <lucide-icon
            [attr.aria-hidden]="true"
            [img]="PlusIcon"
            size="20"
            class="icon"
          ></lucide-icon>
          {{ 'projects.members.addMember' | translate }}
        </button>
      </div>
    }

    @if (errorMessage()) {
      <div class="error-message">{{ errorMessage() }}</div>
    }

    @if (isLoading()) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>{{ 'common.loading' | translate }}</p>
      </div>
    } @else if (members().length === 0) {
      <div class="empty-state">
        <h3>{{ 'projects.members.noMembers' | translate }}</h3>
        <p>{{ 'projects.members.noMembersMessage' | translate }}</p>
      </div>
    } @else {
      <div class="members-list">
        @for (member of members(); track member.id) {
          <div class="member-card">
            <div class="member-info">
              <h3>{{ member.userName }}</h3>
              <p class="member-email">{{ member.userEmail }}</p>
            </div>
            <div class="member-actions">
              <span class="role-badge" [class.role-admin]="member.role === ProjectRole.ADMIN">
                {{ getRoleLabel(member.role) | translate }}
              </span>
              @if (canRemove(member)) {
                <button class="button-danger" (click)="onRemoveMember(member)">
                  {{ 'projects.members.removeMember' | translate }}
                </button>
              }
            </div>
          </div>
        }
      </div>
    }
  </div>
</div>
